<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Idaho Driver's Education Classroom</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<style>
body { background-color: #f9fafb; }
header { background-color: #1e3a8a; color: white; }
nav a { margin: 0 10px; text-decoration: none; font-weight: bold; }
.lesson { display: none; }
.lesson.active { display: block; }
.lesson-part { display: none; }
.lesson-part.active { display: block; }
.disabled-link { cursor: not-allowed; opacity: 0.5; pointer-events: none; }
.lesson-progress { display: flex; gap: 0.5rem; margin-bottom: 1rem; justify-content: center; }
.lesson-progress span { width: 20px; height: 20px; display: inline-block; border-radius: 50%; background-color: #ccc; }
.lesson-progress span.completed { background-color: #16a34a; }
.quiz-option { cursor: pointer; margin: 0.25rem 0; display: flex; align-items: center; }
.square { width: 20px; height: 20px; background: #ccc; display: inline-block; margin-right: 8px; border-radius: 3px; }
</style>
</head>
<body class="min-h-screen flex flex-col">

<header class="p-4 text-center">
  <h1 class="text-3xl font-bold">Idaho Driver's Education Classroom</h1>
  <p class="mt-1">Interactive Lessons & Practice Test</p>
</header>

<nav class="bg-blue-800 p-3 text-center">
  <a href="#" id="lessons-link" class="text-white">Lessons</a>
  <a href="#" id="final-link" class="text-white disabled-link">Final Quiz</a>
</nav>

<main class="flex-1 p-6 max-w-4xl mx-auto">
  <div id="lesson-progress" class="lesson-progress"></div>
  <div id="lessons-container">
    <p class="text-center text-gray-500">Loading lessons...</p>
  </div>
</main>

<!-- Final quiz -->
<section id="final" class="lesson">
  <h2 class="text-2xl font-bold">Final Quiz</h2>
  <p class="mt-2 text-gray-700">Congratulations! Take the final test here after completing all lessons.</p>
</section>

<script>
let lessonsData = [
  {
    title: "Basic Traffic Rules",
    why: "Know these to stay safe on the road.",
    parts: [
      {
        title: "Signs",
        content: "Learn the basic traffic signs.",
        quiz: [
          {
            question: "What does a stop sign mean?",
            options: ["Stop completely", "Slow down only", "Ignore"],
            answer: "Stop completely"
          },
          {
            question: "What does a yield sign mean?",
            options: ["Stop completely", "Give way to others", "Go fast"],
            answer: "Give way to others"
          }
        ]
      },
      {
        title: "Speed Limits",
        content: "Observe posted speed limits.",
        quiz: [
          {
            question: "Max speed in residential area?",
            options: ["25 mph", "50 mph", "70 mph"],
            answer: "25 mph"
          }
        ]
      }
    ]
  },
  {
    title: "Safe Driving Practices",
    why: "Safe driving prevents accidents.",
    parts: [
      {
        title: "Seat Belts",
        content: "Always wear your seat belt.",
        quiz: [
          {
            question: "Should you wear a seatbelt?",
            options: ["Yes", "No"],
            answer: "Yes"
          }
        ]
      }
    ]
  }
];

let lessonsCompleted = {};
let totalLessons = lessonsData.length;

// Render lesson progress tracker
function renderProgress(){
  const progressContainer = document.getElementById('lesson-progress');
  progressContainer.innerHTML = '';
  for(let i=1;i<=totalLessons;i++){
    const span = document.createElement('span');
    span.id = `progress-${i}`;
    if(lessonsCompleted[`lesson${i}`]) span.classList.add('completed');
    progressContainer.appendChild(span);
  }
}

// Render all lessons
function renderLessons(){
  const container = document.getElementById('lessons-container');
  container.innerHTML = '';

  lessonsData.forEach((lesson, idx)=>{
    const lessonSection = document.createElement('section');
    lessonSection.id = 'lesson'+(idx+1);
    lessonSection.className = 'lesson';
    if(idx===0) lessonSection.classList.add('active');

    const title = document.createElement('h2');
    title.className='text-2xl font-bold mb-2';
    title.textContent = `Lesson ${idx+1}: ${lesson.title}`;
    lessonSection.appendChild(title);

    lesson.parts.forEach((part,pIdx)=>{
      const partDiv = document.createElement('div');
      partDiv.className = 'lesson-part';
      if(pIdx===0) partDiv.classList.add('active');

      const partTitle = document.createElement('h3');
      partTitle.className = 'font-semibold mb-1';
      partTitle.textContent = `Part ${pIdx+1}: ${part.title}`;
      partDiv.appendChild(partTitle);

      const partContent = document.createElement('p');
      partContent.textContent = part.content;
      partDiv.appendChild(partContent);

      // Quiz
      if(part.quiz){
        part.quiz.forEach((q,qIdx)=>{
          const qDiv = document.createElement('div');
          qDiv.className='mb-2';
          const qText = document.createElement('p');
          qText.textContent = `${qIdx+1}. ${q.question}`;
          qDiv.appendChild(qText);

          q.options.forEach(opt=>{
            const optDiv = document.createElement('div');
            optDiv.className='quiz-option';
            optDiv.dataset.correct = (opt === q.answer) ? "true" : "false";
            const square = document.createElement('span');
            square.className = 'square';
            optDiv.appendChild(square);
            optDiv.appendChild(document.createTextNode(opt));

            // Click handler for instant feedback
            optDiv.addEventListener('click', ()=>{
              if(optDiv.dataset.correct === "true"){
                square.style.background = 'green';
              } else {
                square.style.background = 'red';
              }
              // Mark lesson complete if all correct answered
              const allSquares = partDiv.querySelectorAll('.quiz-option span');
              let allCorrect = true;
              part.quiz.forEach((qCheck, i)=>{
                const userSquare = partDiv.querySelectorAll('.quiz-option span')[i];
                if(userSquare.style.background !== 'green') allCorrect = false;
              });
              if(allCorrect){
                lessonsCompleted['lesson'+(idx+1)] = true;
                renderProgress();
                const nextLessonNum = idx+2;
                if(nextLessonNum <= totalLessons) showLesson('lesson'+nextLessonNum);
                // Unlock final quiz if all lessons complete
                if(Object.keys(lessonsCompleted).length === totalLessons){
                  const finalLink = document.getElementById('final-link');
                  finalLink.classList.remove('disabled-link');
                  finalLink.onclick = e => { e.preventDefault(); showLesson('final'); };
                }
              }
            });

            qDiv.appendChild(optDiv);
          });

          partDiv.appendChild(qDiv);
        });
      }

      // Navigation buttons
      const navDiv = document.createElement('div');
      navDiv.className='flex justify-between mt-4';
      if(pIdx>0){
        const prevBtn = document.createElement('button');
        prevBtn.className='p-2 bg-gray-500 text-white rounded hover:bg-gray-400';
        prevBtn.textContent='← Previous';
        prevBtn.onclick=()=>prevPart(prevBtn);
        navDiv.appendChild(prevBtn);
      }
      if(pIdx<lesson.parts.length-1){
        const nextBtn = document.createElement('button');
        nextBtn.className='p-2 bg-blue-700 text-white rounded hover:bg-blue-600';
        nextBtn.textContent='Next →';
        nextBtn.onclick=()=>nextPart(nextBtn);
        navDiv.appendChild(nextBtn);
      }
      partDiv.appendChild(navDiv);

      lessonSection.appendChild(partDiv);
    });

    container.appendChild(lessonSection);
  });
}

// Show lesson and reset first part
function showLesson(id){
  document.querySelectorAll('.lesson').forEach(s=>s.classList.remove('active'));
  document.querySelectorAll('.lesson-part').forEach(p=>p.classList.remove('active'));
  const lessonEl = document.getElementById(id);
  if(!lessonEl) return;
  lessonEl.classList.add('active');
  const firstPart = lessonEl.querySelector('.lesson-part');
  if(firstPart) firstPart.classList.add('active');
}

// Navigation helpers
function nextPart(button){
  const parts = button.closest('.lesson').querySelectorAll('.lesson-part');
  for(let i=0;i<parts.length;i++){
    if(parts[i].classList.contains('active')){
      if(i<parts.length-1){
        parts[i].classList.remove('active');
        parts[i+1].classList.add('active');
      }
      break;
    }
  }
}
function prevPart(button){
  const parts = button.closest('.lesson').querySelectorAll('.lesson-part');
  for(let i=0;i<parts.length;i++){
    if(parts[i].classList.contains('active')){
      if(i>0){
        parts[i].classList.remove('active');
        parts[i-1].classList.add('active');
      }
      break;
    }
  }
}

// Initial render
renderLessons();
renderProgress();
document.getElementById('lessons-link').onclick = e => { e.preventDefault(); showLesson('lesson1'); };
document.getElementById('final-link').onclick = e => { e.preventDefault(); alert('Complete all lessons first.'); };

</script>
</body>
</html>
